<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spread model coefficients of list-variables into columns — spread_coef • sjmisc</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Spread model coefficients of list-variables into columns — spread_coef" />

<meta property="og:description" content="This function extracts coefficients (and standard error and
             p-values) of fitted model objects from (nested) data frames,
             which are saved in a list-variable, and spreads the coefficients
             into new colummns." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sjmisc</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.7.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/design_philosophy.html">The Design Philosophy of Functions in sjmisc</a>
    </li>
    <li>
      <a href="../articles/exploringdatasets.html">Exploring Data Sets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/strengejacke/sjmisc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spread model coefficients of list-variables into columns</h1>
    <small class="dont-index">Source: <a href='https://github.com/strengejacke/sjmisc/blob/master/R/spread_coef.R'><code>R/spread_coef.R</code></a></small>
    <div class="hidden name"><code>spread_coef.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function extracts coefficients (and standard error and
             p-values) of fitted model objects from (nested) data frames,
             which are saved in a list-variable, and spreads the coefficients
             into new colummns.</p>
    
    </div>

    <pre class="usage"><span class='fu'>spread_coef</span>(<span class='no'>data</span>, <span class='no'>model.column</span>, <span class='no'>model.term</span>, <span class='no'>se</span>, <span class='no'>p.val</span>, <span class='kw'>append</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A (nested) data frame with a list-variable that contains fitted
model objects (see 'Details').</p></td>
    </tr>
    <tr>
      <th>model.column</th>
      <td><p>Name or index of the list-variable that contains the
fitted model objects.</p></td>
    </tr>
    <tr>
      <th>model.term</th>
      <td><p>Optional, name of a model term. If specified, only this model
term (including p-value) will be extracted from each model and
added as new column.</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>Logical, if <code>TRUE</code>, standard errors for estimates will also be extracted.</p></td>
    </tr>
    <tr>
      <th>p.val</th>
      <td><p>Logical, if <code>TRUE</code>, p-values for estimates will also be extracted.</p></td>
    </tr>
    <tr>
      <th>append</th>
      <td><p>Logical, if <code>TRUE</code> (default), this function returns
<code>data</code> with new columns for the model coefficients; else,
a new data frame with model coefficients only are returned.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed down to the <code><a href='http://www.rdocumentation.org/packages/broom/topics/tidy'>tidy</a></code>-function.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with columns for each coefficient of the models
          that are stored in the list-variable of <code>data</code>; or, if
          <code>model.term</code> is given, a data frame with the term's estimate.
          If <code>se = TRUE</code> or <code>p.val = TRUE</code>, the returned data frame
          also contains columns for the coefficients' standard error and
          p-value.
          If <code>append = TRUE</code>, the columns are appended to <code>data</code>,
          i.e. <code>data</code> is also returned.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function requires a (nested) data frame (e.g. created by the
           <code><a href='http://www.rdocumentation.org/packages/tidyr/topics/nest'>nest</a></code>-function of the <span class="pkg">tidyr</span>-package),
           where several fitted models are saved in a list-variable (see
           'Examples'). Since nested data frames with fitted models stored as list-variable
           are typically fit with an identical formula, all models have the same
           dependent and independent variables and only differ in their
           subsets of data. The function then extracts all coefficients from
           each model and saves each estimate in a new column. The result
           is a data frame, where each <em>row</em> is a model with each
           model's coefficients in an own <em>column</em>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>dplyr</span>)
<span class='fu'>library</span>(<span class='no'>tidyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'tidyr'</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:mice':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    complete</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:sjmisc':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    replace_na</span></div><div class='input'><span class='fu'>library</span>(<span class='no'>purrr</span>)
<span class='fu'>data</span>(<span class='no'>efc</span>)

<span class='co'># create nested data frame, grouped by dependency (e42dep)</span>
<span class='co'># and fit linear model for each group. These models are</span>
<span class='co'># stored in the list variable "models".</span>
<span class='no'>model.data</span> <span class='kw'>&lt;-</span> <span class='no'>efc</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(!<span class='fu'>is.na</span>(<span class='no'>e42dep</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>e42dep</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/tidyr/topics/nest'>nest</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(
    <span class='kw'>models</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/purrr/topics/map'>map</a></span>(<span class='no'>data</span>, ~<span class='fu'>lm</span>(<span class='no'>neg_c_7</span> ~ <span class='no'>c12hour</span> + <span class='no'>c172code</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>.x</span>))
  )

<span class='co'># spread coefficients, so we can easily access and compare the</span>
<span class='co'># coefficients over all models. arguments `se` and `p.val` default</span>
<span class='co'># to `FALSE`, when `model.term` is not specified</span>
<span class='fu'>spread_coef</span>(<span class='no'>model.data</span>, <span class='no'>models</span>)</div><div class='output co'>#&gt; # A tibble: 4 x 6
#&gt;   e42dep data                models   `(Intercept)` c12hour c172code
#&gt;    &lt;dbl&gt; &lt;list&gt;              &lt;list&gt;           &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1      3 &lt;tibble [306 x 25]&gt; &lt;S3: lm&gt;         10.9  0.00372   0.385 
#&gt; 2      4 &lt;tibble [304 x 25]&gt; &lt;S3: lm&gt;         13.0  0.00824   0.0491
#&gt; 3      1 &lt;tibble [66 x 25]&gt;  &lt;S3: lm&gt;         10.9  0.0128   -1.00  
#&gt; 4      2 &lt;tibble [225 x 25]&gt; &lt;S3: lm&gt;          8.27 0.0345    0.770 </div><div class='input'><span class='fu'>spread_coef</span>(<span class='no'>model.data</span>, <span class='no'>models</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; # A tibble: 4 x 9
#&gt;   e42dep data  models `(Intercept)` `(Intercept).se` c12hour c12hour.se c172code
#&gt;    &lt;dbl&gt; &lt;lis&gt; &lt;list&gt;         &lt;dbl&gt;            &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1      3 &lt;tib~ &lt;S3: ~         10.9             0.681 0.00372    0.00485   0.385 
#&gt; 2      4 &lt;tib~ &lt;S3: ~         13.0             0.925 0.00824    0.00419   0.0491
#&gt; 3      1 &lt;tib~ &lt;S3: ~         10.9             1.34  0.0128     0.0391   -1.00  
#&gt; 4      2 &lt;tib~ &lt;S3: ~          8.27            0.786 0.0345     0.0151    0.770 
#&gt; # ... with 1 more variable: c172code.se &lt;dbl&gt;</div><div class='input'>
<span class='co'># select only specific model term. `se` and `p.val` default to `TRUE`</span>
<span class='fu'>spread_coef</span>(<span class='no'>model.data</span>, <span class='no'>models</span>, <span class='no'>c12hour</span>)</div><div class='output co'>#&gt; # A tibble: 4 x 6
#&gt;   e42dep data                models   c12hour std.error p.value
#&gt;    &lt;dbl&gt; &lt;list&gt;              &lt;list&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1      3 &lt;tibble [306 x 25]&gt; &lt;S3: lm&gt; 0.00372   0.00485  0.443 
#&gt; 2      4 &lt;tibble [304 x 25]&gt; &lt;S3: lm&gt; 0.00824   0.00419  0.0502
#&gt; 3      1 &lt;tibble [66 x 25]&gt;  &lt;S3: lm&gt; 0.0128    0.0391   0.745 
#&gt; 4      2 &lt;tibble [225 x 25]&gt; &lt;S3: lm&gt; 0.0345    0.0151   0.0237</div><div class='input'>
<span class='co'># spread_coef can be used directly within a pipe-chain</span>
<span class='no'>efc</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(!<span class='fu'>is.na</span>(<span class='no'>e42dep</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>e42dep</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/tidyr/topics/nest'>nest</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(
    <span class='kw'>models</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/purrr/topics/map'>map</a></span>(<span class='no'>data</span>, ~<span class='fu'>lm</span>(<span class='no'>neg_c_7</span> ~ <span class='no'>c12hour</span> + <span class='no'>c172code</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>.x</span>))
  ) <span class='kw'>%&gt;%</span>
  <span class='fu'>spread_coef</span>(<span class='no'>models</span>)</div><div class='output co'>#&gt; # A tibble: 4 x 6
#&gt;   e42dep data                models   `(Intercept)` c12hour c172code
#&gt;    &lt;dbl&gt; &lt;list&gt;              &lt;list&gt;           &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1      3 &lt;tibble [306 x 25]&gt; &lt;S3: lm&gt;         10.9  0.00372   0.385 
#&gt; 2      4 &lt;tibble [304 x 25]&gt; &lt;S3: lm&gt;         13.0  0.00824   0.0491
#&gt; 3      1 &lt;tibble [66 x 25]&gt;  &lt;S3: lm&gt;         10.9  0.0128   -1.00  
#&gt; 4      2 &lt;tibble [225 x 25]&gt; &lt;S3: lm&gt;          8.27 0.0345    0.770 </div><div class='input'>
<span class='co'># spread_coef() makes it easy to generate bootstrapped</span>
<span class='co'># confidence intervals, using the 'bootstrap()' and 'boot_ci()'</span>
<span class='co'># functions from the 'sjstats' package, which creates nested</span>
<span class='co'># data frames of bootstrap replicates</span>
<span class='fu'>library</span>(<span class='no'>sjstats</span>)
<span class='no'>efc</span> <span class='kw'>%&gt;%</span>
  <span class='co'># generate bootstrap replicates</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/sjstats/topics/bootstrap'>bootstrap</a></span>(<span class='fl'>100</span>) <span class='kw'>%&gt;%</span>
  <span class='co'># apply lm to all bootstrapped data sets</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(
    <span class='kw'>models</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/purrr/topics/map'>map</a></span>(<span class='no'>strap</span>, ~<span class='fu'>lm</span>(<span class='no'>neg_c_7</span> ~ <span class='no'>e42dep</span> + <span class='no'>c161sex</span> + <span class='no'>c172code</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>.x</span>))
  ) <span class='kw'>%&gt;%</span>
  <span class='co'># spread model coefficient for all 100 models</span>
  <span class='fu'>spread_coef</span>(<span class='no'>models</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>p.val</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>) <span class='kw'>%&gt;%</span>
  <span class='co'># compute the CI for all bootstrapped model coefficients</span>
  <span class='fu'><a href='http://www.rdocumentation.org/packages/sjstats/topics/boot_ci'>boot_ci</a></span>(<span class='no'>e42dep</span>, <span class='no'>c161sex</span>, <span class='no'>c172code</span>)</div><div class='output co'>#&gt;       term    conf.low conf.high
#&gt; 1   e42dep  1.30763889 1.8195137
#&gt; 2  c161sex  0.04008001 1.1543226
#&gt; 3 c172code -0.16382340 0.6815886</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Lüdecke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

